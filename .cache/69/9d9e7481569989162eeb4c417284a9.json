{"id":"parse/get-written-durations.ts","dependencies":[{"name":"/home/aled/solo-composer-ui/tsconfig.json","includedInParent":true,"mtime":1598401787877},{"name":"/home/aled/solo-composer-ui/package.json","includedInParent":true,"mtime":1598459868758},{"name":"./split-at-tone-events","loc":{"line":1,"column":34},"parent":"/home/aled/solo-composer-ui/src/parse/get-written-durations.ts","resolved":"/home/aled/solo-composer-ui/src/parse/split-at-tone-events.ts"},{"name":"./split-as-per-meter","loc":{"line":2,"column":32},"parent":"/home/aled/solo-composer-ui/src/parse/get-written-durations.ts","resolved":"/home/aled/solo-composer-ui/src/parse/split-as-per-meter.ts"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getWrittenDurations = getWrittenDurations;\n\nvar _splitAtToneEvents = require(\"./split-at-tone-events\");\n\nvar _splitAsPerMeter = require(\"./split-as-per-meter\");\n\n/**\n * Convert tones into written notation values\n */\nfunction getWrittenDurations(players, instruments, flow, barlines) {\n  return players.order.reduce(function (output, player_key) {\n    if (flow.players[player_key]) {\n      var player = players.by_key[player_key];\n      player.instruments.forEach(function (instrument_key) {\n        var instrument = instruments[instrument_key];\n        instrument.staves.forEach(function (stave_key) {\n          var stave = flow.staves[stave_key];\n          stave.tracks.order.forEach(function (track_key) {\n            var track = stave.tracks.by_key[track_key];\n            var notation = (0, _splitAtToneEvents.splitAtToneEvents)(flow.length, track);\n            output[track_key] = (0, _splitAsPerMeter.splitAsPerMeter)(flow, notation, barlines);\n          });\n        });\n      });\n    }\n\n    return output;\n  }, {});\n}"},"sourceMaps":{"js":{"mappings":[{"source":"parse/get-written-durations.ts","name":null,"original":{"line":5,"column":0},"generated":{"line":8,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":6,"column":0},"generated":{"line":10,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":8,"column":0},"generated":{"line":12,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":11,"column":6},"generated":{"line":15,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":11,"column":16},"generated":{"line":15,"column":9}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":11,"column":6},"generated":{"line":15,"column":28}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":12,"column":4},"generated":{"line":15,"column":29}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":11,"column":6},"generated":{"line":15,"column":36}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":13,"column":4},"generated":{"line":15,"column":38}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":11,"column":6},"generated":{"line":15,"column":49}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":14,"column":4},"generated":{"line":15,"column":51}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":11,"column":6},"generated":{"line":15,"column":55}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":15,"column":4},"generated":{"line":15,"column":57}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":11,"column":6},"generated":{"line":15,"column":65}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":15,"column":25},"generated":{"line":15,"column":67}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":4},"generated":{"line":16,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":11},"generated":{"line":16,"column":9}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":18},"generated":{"line":16,"column":16}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":19},"generated":{"line":16,"column":17}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":11},"generated":{"line":16,"column":22}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":25},"generated":{"line":16,"column":23}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":11},"generated":{"line":16,"column":29}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":48},"generated":{"line":16,"column":30}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":49},"generated":{"line":16,"column":40}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":48},"generated":{"line":16,"column":46}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":57},"generated":{"line":16,"column":48}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":48},"generated":{"line":16,"column":58}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":67},"generated":{"line":16,"column":60}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":8},"generated":{"line":17,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":12},"generated":{"line":17,"column":8}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":16},"generated":{"line":17,"column":12}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":17},"generated":{"line":17,"column":13}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":12},"generated":{"line":17,"column":20}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":25},"generated":{"line":17,"column":21}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":12},"generated":{"line":17,"column":31}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":8},"generated":{"line":17,"column":32}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":18,"column":38},"generated":{"line":17,"column":34}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":12},"generated":{"line":18,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":18},"generated":{"line":18,"column":10}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":24},"generated":{"line":18,"column":16}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":27},"generated":{"line":18,"column":19}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":34},"generated":{"line":18,"column":26}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":35},"generated":{"line":18,"column":27}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":27},"generated":{"line":18,"column":33}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":42},"generated":{"line":18,"column":34}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":27},"generated":{"line":18,"column":44}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":19,"column":12},"generated":{"line":18,"column":45}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":19,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":19,"column":6}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":18},"generated":{"line":19,"column":12}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":19},"generated":{"line":19,"column":13}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":19,"column":24}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":31},"generated":{"line":19,"column":25}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":19,"column":32}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":39},"generated":{"line":19,"column":33}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":40},"generated":{"line":19,"column":43}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":39},"generated":{"line":19,"column":57}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":54},"generated":{"line":19,"column":59}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":16},"generated":{"line":20,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":22},"generated":{"line":20,"column":12}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":32},"generated":{"line":20,"column":22}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":35},"generated":{"line":20,"column":25}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":46},"generated":{"line":20,"column":36}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":47},"generated":{"line":20,"column":37}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":46},"generated":{"line":20,"column":51}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":21,"column":16},"generated":{"line":20,"column":52}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":21,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":21,"column":8}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":26},"generated":{"line":21,"column":18}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":27},"generated":{"line":21,"column":19}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":21,"column":25}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":34},"generated":{"line":21,"column":26}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":21,"column":33}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":42},"generated":{"line":21,"column":34}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":43},"generated":{"line":21,"column":44}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":42},"generated":{"line":21,"column":53}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":52},"generated":{"line":21,"column":55}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":20},"generated":{"line":22,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":26},"generated":{"line":22,"column":14}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":31},"generated":{"line":22,"column":19}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":34},"generated":{"line":22,"column":22}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":38},"generated":{"line":22,"column":26}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":39},"generated":{"line":22,"column":27}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":34},"generated":{"line":22,"column":33}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":46},"generated":{"line":22,"column":34}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":34},"generated":{"line":22,"column":43}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":23,"column":20},"generated":{"line":22,"column":44}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":20},"generated":{"line":23,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":20},"generated":{"line":23,"column":10}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":25},"generated":{"line":23,"column":15}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":26},"generated":{"line":23,"column":16}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":20},"generated":{"line":23,"column":22}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":33},"generated":{"line":23,"column":23}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":20},"generated":{"line":23,"column":28}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":39},"generated":{"line":23,"column":29}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":20},"generated":{"line":23,"column":36}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":47},"generated":{"line":23,"column":37}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":48},"generated":{"line":23,"column":47}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":47},"generated":{"line":23,"column":56}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":57},"generated":{"line":23,"column":58}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":24},"generated":{"line":24,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":30},"generated":{"line":24,"column":16}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":35},"generated":{"line":24,"column":21}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":38},"generated":{"line":24,"column":24}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":43},"generated":{"line":24,"column":29}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":44},"generated":{"line":24,"column":30}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":38},"generated":{"line":24,"column":36}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":51},"generated":{"line":24,"column":37}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":38},"generated":{"line":24,"column":43}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":58},"generated":{"line":24,"column":44}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":38},"generated":{"line":24,"column":53}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":25,"column":24},"generated":{"line":24,"column":54}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":24},"generated":{"line":25,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":30},"generated":{"line":25,"column":16}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":38},"generated":{"line":25,"column":24}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":41},"generated":{"line":25,"column":27}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":59},"generated":{"line":25,"column":69}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":63},"generated":{"line":25,"column":73}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":64},"generated":{"line":25,"column":74}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":41},"generated":{"line":25,"column":80}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":72},"generated":{"line":25,"column":82}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":41},"generated":{"line":25,"column":87}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":26,"column":24},"generated":{"line":25,"column":88}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":24},"generated":{"line":26,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":24},"generated":{"line":26,"column":12}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":30},"generated":{"line":26,"column":18}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":31},"generated":{"line":26,"column":19}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":30},"generated":{"line":26,"column":28}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":24},"generated":{"line":26,"column":29}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":44},"generated":{"line":26,"column":32}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":28,"column":28},"generated":{"line":26,"column":70}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":44},"generated":{"line":26,"column":74}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":29,"column":28},"generated":{"line":26,"column":76}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":44},"generated":{"line":26,"column":84}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":30,"column":28},"generated":{"line":26,"column":86}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":44},"generated":{"line":26,"column":94}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":27,"column":24},"generated":{"line":26,"column":95}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":32,"column":21},"generated":{"line":27,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":24,"column":20},"generated":{"line":27,"column":11}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":33,"column":17},"generated":{"line":28,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":22,"column":16},"generated":{"line":28,"column":9}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":34,"column":13},"generated":{"line":29,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":20,"column":12},"generated":{"line":29,"column":7}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":35,"column":9},"generated":{"line":30,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":36,"column":8},"generated":{"line":32,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":36,"column":15},"generated":{"line":32,"column":11}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":36,"column":8},"generated":{"line":32,"column":17}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":37,"column":5},"generated":{"line":33,"column":0}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":11},"generated":{"line":33,"column":3}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":37,"column":7},"generated":{"line":33,"column":5}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":11},"generated":{"line":33,"column":7}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":17,"column":4},"generated":{"line":33,"column":8}},{"source":"parse/get-written-durations.ts","name":null,"original":{"line":38,"column":1},"generated":{"line":34,"column":0}}],"sources":{"parse/get-written-durations.ts":"import { Flow } from \"../store/score-flow/defs\";\nimport { NotationTracks } from \"./notation-track\";\nimport { Player } from \"../store/score-player/defs\";\nimport { Instrument } from \"../store/score-instrument/defs\";\nimport { splitAtToneEvents } from \"./split-at-tone-events\";\nimport { splitAsPerMeter } from \"./split-as-per-meter\";\n\n/**\n * Convert tones into written notation values\n */\nexport function getWrittenDurations(\n    players: { order: string[]; by_key: { [key: string]: Player } },\n    instruments: { [key: string]: Instrument },\n    flow: Flow,\n    barlines: Set<number>\n) {\n    return players.order.reduce<NotationTracks>((output, player_key) => {\n        if (flow.players[player_key]) {\n            const player = players.by_key[player_key];\n            player.instruments.forEach((instrument_key) => {\n                const instrument = instruments[instrument_key];\n                instrument.staves.forEach((stave_key) => {\n                    const stave = flow.staves[stave_key];\n                    stave.tracks.order.forEach((track_key) => {\n                        const track = stave.tracks.by_key[track_key];\n                        const notation = splitAtToneEvents(flow.length, track);\n                        output[track_key] = splitAsPerMeter(\n                            flow,\n                            notation,\n                            barlines\n                        );\n                    });\n                });\n            });\n        }\n        return output;\n    }, {});\n}\n"},"lineCount":null}},"error":null,"hash":"6ce93b6523e489bad172e1b0114ec30e","cacheData":{"env":{}}}