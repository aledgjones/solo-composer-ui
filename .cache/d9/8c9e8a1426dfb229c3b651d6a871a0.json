{"id":"O4la","dependencies":[{"name":"/home/aled/solo-composer-ui/tsconfig.json","includedInParent":true,"mtime":1598401787877},{"name":"/home/aled/solo-composer-ui/package.json","includedInParent":true,"mtime":1598403412572},{"name":"../render/path","loc":{"line":1,"column":26},"parent":"/home/aled/solo-composer-ui/src/parse/draw-staves.ts","resolved":"/home/aled/solo-composer-ui/src/render/path.ts"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.drawStaves=r;var e=require(\"../render/path\");function r(r,t,s,n,a,i,u,o){var c={color:\"#000000\",thickness:.125},h=[],f=n.order.reduce(function(e,r){i.players[r]&&n.by_key[r].instruments.forEach(function(r){a[r].staves.forEach(function(r){e.push(i.staves[r])})});return e},[]);return f.forEach(function(n){for(var a=0;a<n.lines.length;a++)if(1===n.lines[a]){var i=t+u.staves[n.key].y+a;h.push((0,e.buildPath)(n.key+\"-stave-\"+a,c,[r,i],[r+s,i]))}}),(f.length>1||o)&&h.push((0,e.buildPath)(\"systemic-barline\",c,[r,t-.0625],[r,t+u.height+.0625])),h}"},"sourceMaps":{"js":{"mappings":[{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":0}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":13}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":20}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":35}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":43}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":56}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":57}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":64}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":68}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":76}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":66,"column":1},"generated":{"line":1,"column":87}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":89}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":93}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":95}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":2,"column":0},"generated":{"line":1,"column":103}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":8,"column":6},"generated":{"line":1,"column":121}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":8,"column":16},"generated":{"line":1,"column":130}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":9,"column":4},"generated":{"line":1,"column":132}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":10,"column":4},"generated":{"line":1,"column":134}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":11,"column":4},"generated":{"line":1,"column":136}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":12,"column":4},"generated":{"line":1,"column":138}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":13,"column":4},"generated":{"line":1,"column":140}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":14,"column":4},"generated":{"line":1,"column":142}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":15,"column":4},"generated":{"line":1,"column":144}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":16,"column":4},"generated":{"line":1,"column":146}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":18,"column":10},"generated":{"line":1,"column":149}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":19,"column":10},"generated":{"line":1,"column":153}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":19,"column":19},"generated":{"line":1,"column":155}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":19,"column":21},"generated":{"line":1,"column":156}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":19,"column":28},"generated":{"line":1,"column":162}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":19,"column":39},"generated":{"line":1,"column":172}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":19,"column":50},"generated":{"line":1,"column":182}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":21,"column":10},"generated":{"line":1,"column":188}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":21,"column":37},"generated":{"line":1,"column":190}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":23,"column":10},"generated":{"line":1,"column":193}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":23,"column":19},"generated":{"line":1,"column":195}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":23,"column":27},"generated":{"line":1,"column":197}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":23,"column":33},"generated":{"line":1,"column":203}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":23,"column":49},"generated":{"line":1,"column":210}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":23,"column":50},"generated":{"line":1,"column":219}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":23,"column":55},"generated":{"line":1,"column":221}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":24,"column":12},"generated":{"line":1,"column":224}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":24,"column":17},"generated":{"line":1,"column":226}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":24,"column":25},"generated":{"line":1,"column":234}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":25,"column":27},"generated":{"line":1,"column":238}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":25,"column":35},"generated":{"line":1,"column":240}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":25,"column":42},"generated":{"line":1,"column":247}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":26,"column":19},"generated":{"line":1,"column":250}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":26,"column":31},"generated":{"line":1,"column":262}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":26,"column":39},"generated":{"line":1,"column":270}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":26,"column":40},"generated":{"line":1,"column":279}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":27,"column":35},"generated":{"line":1,"column":282}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":27,"column":47},"generated":{"line":1,"column":284}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":28,"column":27},"generated":{"line":1,"column":287}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":28,"column":34},"generated":{"line":1,"column":294}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":28,"column":42},"generated":{"line":1,"column":302}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":28,"column":43},"generated":{"line":1,"column":311}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":29,"column":20},"generated":{"line":1,"column":314}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":29,"column":24},"generated":{"line":1,"column":316}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":29,"column":29},"generated":{"line":1,"column":321}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":29,"column":34},"generated":{"line":1,"column":323}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":29,"column":41},"generated":{"line":1,"column":330}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":33,"column":15},"generated":{"line":1,"column":338}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":33,"column":15},"generated":{"line":1,"column":345}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":34,"column":7},"generated":{"line":1,"column":348}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":65,"column":11},"generated":{"line":1,"column":352}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":37,"column":4},"generated":{"line":1,"column":359}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":37,"column":11},"generated":{"line":1,"column":361}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":37,"column":19},"generated":{"line":1,"column":369}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":37,"column":20},"generated":{"line":1,"column":378}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":13},"generated":{"line":1,"column":381}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":13},"generated":{"line":1,"column":385}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":17},"generated":{"line":1,"column":389}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":21},"generated":{"line":1,"column":391}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":24},"generated":{"line":1,"column":393}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":28},"generated":{"line":1,"column":395}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":34},"generated":{"line":1,"column":397}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":40},"generated":{"line":1,"column":403}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":38,"column":48},"generated":{"line":1,"column":410}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":39,"column":16},"generated":{"line":1,"column":414}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":39,"column":35},"generated":{"line":1,"column":417}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":39,"column":16},"generated":{"line":1,"column":421}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":39,"column":22},"generated":{"line":1,"column":423}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":39,"column":28},"generated":{"line":1,"column":429}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":39,"column":38},"generated":{"line":1,"column":432}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":22},"generated":{"line":1,"column":433}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":22},"generated":{"line":1,"column":437}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":30},"generated":{"line":1,"column":439}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":34},"generated":{"line":1,"column":441}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":50},"generated":{"line":1,"column":443}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":57},"generated":{"line":1,"column":450}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":63},"generated":{"line":1,"column":452}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":68},"generated":{"line":1,"column":457}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":40,"column":72},"generated":{"line":1,"column":459}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":41,"column":16},"generated":{"line":1,"column":461}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":41,"column":22},"generated":{"line":1,"column":463}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":42,"column":20},"generated":{"line":1,"column":469}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":43,"column":27},"generated":{"line":1,"column":471}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":43,"column":27},"generated":{"line":1,"column":473}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":43,"column":27},"generated":{"line":1,"column":484}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":43,"column":33},"generated":{"line":1,"column":486}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":43,"column":36},"generated":{"line":1,"column":490}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":43,"column":46},"generated":{"line":1,"column":500}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":44,"column":24},"generated":{"line":1,"column":502}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":45,"column":24},"generated":{"line":1,"column":504}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":45,"column":25},"generated":{"line":1,"column":505}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":45,"column":28},"generated":{"line":1,"column":507}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":46,"column":24},"generated":{"line":1,"column":510}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":46,"column":25},"generated":{"line":1,"column":511}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":46,"column":29},"generated":{"line":1,"column":513}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":46,"column":36},"generated":{"line":1,"column":515}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":54,"column":8},"generated":{"line":1,"column":524}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":54,"column":15},"generated":{"line":1,"column":526}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":54,"column":24},"generated":{"line":1,"column":533}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":54,"column":29},"generated":{"line":1,"column":536}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":55,"column":8},"generated":{"line":1,"column":540}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":55,"column":14},"generated":{"line":1,"column":542}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":56,"column":12},"generated":{"line":1,"column":548}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":57,"column":16},"generated":{"line":1,"column":550}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":57,"column":16},"generated":{"line":1,"column":552}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":57,"column":16},"generated":{"line":1,"column":563}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":58,"column":16},"generated":{"line":1,"column":582}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":59,"column":16},"generated":{"line":1,"column":584}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":59,"column":17},"generated":{"line":1,"column":585}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":59,"column":20},"generated":{"line":1,"column":587}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":18,"column":35},"generated":{"line":1,"column":589}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":60,"column":16},"generated":{"line":1,"column":596}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":60,"column":17},"generated":{"line":1,"column":597}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":60,"column":20},"generated":{"line":1,"column":599}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":60,"column":24},"generated":{"line":1,"column":601}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":60,"column":40},"generated":{"line":1,"column":603}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":18,"column":35},"generated":{"line":1,"column":610}},{"source":"parse/draw-staves.ts","name":null,"original":{"line":65,"column":11},"generated":{"line":1,"column":619}}],"sources":{"parse/draw-staves.ts":"import { VerticalLayout } from \"./measure-verical-spacing\";\nimport { PathInstruction, buildPath } from \"../render/path\";\nimport { Player } from \"../store/score-player/defs\";\nimport { Instrument } from \"../store/score-instrument/defs\";\nimport { Flow } from \"../store/score-flow/defs\";\nimport { Stave } from \"../store/score-stave/defs\";\n\nexport function drawStaves(\n    x: number,\n    y: number,\n    width: number,\n    players: { order: string[]; by_key: { [key: string]: Player } },\n    instruments: { [key: string]: Instrument },\n    flow: Flow,\n    vertical_layout: VerticalLayout,\n    drawSystemicBarlineSingleStave: boolean\n) {\n    const tweakForStaveLineWidth = 0.0625;\n    const styles = { color: \"#000000\", thickness: 0.125 };\n\n    const paths: PathInstruction[] = [];\n\n    const staves = players.order.reduce<Stave[]>((out, player_key) => {\n        if (flow.players[player_key]) {\n            const player = players.by_key[player_key];\n            player.instruments.forEach((instrument_key) => {\n                const instrument = instruments[instrument_key];\n                instrument.staves.forEach((stave_key) => {\n                    out.push(flow.staves[stave_key]);\n                });\n            });\n        }\n        return out;\n    }, []);\n\n    // render staves\n    staves.forEach((stave) => {\n        for (let i = 0; i < stave.lines.length; i++) {\n            if (stave.lines[i] === 1) {\n                const start = y + vertical_layout.staves[stave.key].y + i;\n                paths.push(\n                    buildPath(\n                        `${stave.key}-stave-${i}`,\n                        styles,\n                        [x, start],\n                        [x + width, start]\n                    )\n                );\n            }\n        }\n    });\n\n    // render stystemic barline\n    if (staves.length > 1 || drawSystemicBarlineSingleStave) {\n        paths.push(\n            buildPath(\n                \"systemic-barline\",\n                styles,\n                [x, y - tweakForStaveLineWidth],\n                [x, y + vertical_layout.height + tweakForStaveLineWidth]\n            )\n        );\n    }\n\n    return paths;\n}\n"},"lineCount":null}},"error":null,"hash":"808c67c56ea13e723633d216b26fe7bc","cacheData":{"env":{}}}